(include "ad.egg")

(push)

(let x (Var "x"))
(let n (Int 10))
(let v (Build n (Lam "i" x)))
(let w (Var "v"))
(let y (IFold (Lam "a" (Lam "i" (Mul (Var "a") (Get v (Var "i"))))) (Const 1.) (Length v)))
(let f (Lam "x" y))
(let z (IFold (Lam "a" (Lam "i" (Add (Var "a") (Get w (Var "i"))))) (Const 0.) (Length w)))
(let g (Lam "v" z))

(let fd (Diff f))
(let gd (Grad g))

(run ad 50)

;(output "expr.egg" gd)

;(pop)

;(include "expr.egg")
