(include "ad.egg")

(push)

(let f (Lam (IFold (Lam (Lam (Add (Var 1) (Get (Var 2) (Var 0))))) (Const 0.) (Length (Var 0)))))

(let fd (Grad f))

(run-schedule (saturate ad))

(output "expr.egg" fd)

(pop)

(include "expr.egg")
